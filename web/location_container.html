<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    <element name="location-container">
      <template>
        <div>
          <ul id="location-list">
            <template iterate="location in locations" >
              <li>{{location.name}}</li>
            </template>
          </ul>        
        </div>
      </template>
      <script type="application/dart">
        import 'package:web_ui/web_ui.dart';
        import 'package:dart_prototype/dart_prototype_library.dart';
   
        class LocationContainer extends WebComponent {
          
          @observable
          WebService locationService;
  
          final ObservableList<Location> locations = new ObservableList<Location>();
       
          LocationContainer() {  
          }      
      
          inserted() {
            refreshLocations();
          }
      
          void refreshLocations() {
            print('refreshing...');
            locationService.call("/locations").then((response) {
                locations.clear();
                locations.addAll(response);
            });
          }
        }        
      </script>
    </element>
  </body>
</html>
